{"version":3,"file":"index.js","sources":["../node_modules/@spectrum-web-components/textfield/src/Textfield.ts","../src/components/menu-item/menu-item.js","../src/events/events.js","../src/components/sidenav/sidenav-item.js","../src/events/eventemitter.js","../src/events/eventbus.js","../src/utils/library.js","../src/store/store.js","../src/models/app-model.js","../src/components/header/header.js","../src/utils/plugin.js","../src/components/illustrated-message/illustrated-message.js","../src/utils/dom.js","../src/views/library-list/library-list.js","../src/views/plugin-renderer/plugin-renderer.js","../src/app.js"],"sourcesContent":["/*\nCopyright 2020 Adobe. All rights reserved.\nThis file is licensed to you under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License. You may obtain a copy\nof the License at http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software distributed under\nthe License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\nOF ANY KIND, either express or implied. See the License for the specific language\ngoverning permissions and limitations under the License.\n*/\n\nimport {\n    CSSResultArray,\n    html,\n    nothing,\n    PropertyValues,\n    TemplateResult,\n} from '@spectrum-web-components/base';\nimport {\n    ifDefined,\n    live,\n} from '@spectrum-web-components/base/src/directives.js';\nimport {\n    property,\n    query,\n    state,\n} from '@spectrum-web-components/base/src/decorators.js';\n\nimport { ManageHelpText } from '@spectrum-web-components/help-text/src/manage-help-text.js';\nimport { Focusable } from '@spectrum-web-components/shared/src/focusable.js';\nimport '@spectrum-web-components/icons-ui/icons/sp-icon-checkmark100.js';\nimport '@spectrum-web-components/icons-workflow/icons/sp-icon-alert.js';\n\nimport textfieldStyles from './textfield.css.js';\nimport checkmarkStyles from '@spectrum-web-components/icon/src/spectrum-icon-checkmark.css.js';\n\nconst textfieldTypes = ['text', 'url', 'tel', 'email', 'password'] as const;\nexport type TextfieldType = typeof textfieldTypes[number];\n\n/**\n * @fires input - The value of the element has changed.\n * @fires change - An alteration to the value of the element has been committed by the user.\n */\nexport class TextfieldBase extends ManageHelpText(Focusable) {\n    public static override get styles(): CSSResultArray {\n        return [textfieldStyles, checkmarkStyles];\n    }\n\n    @property({ attribute: 'allowed-keys' })\n    allowedKeys = '';\n\n    @property({ type: Boolean, reflect: true })\n    public focused = false;\n\n    @query('.input')\n    protected inputElement!: HTMLInputElement | HTMLTextAreaElement;\n\n    @property({ type: Boolean, reflect: true })\n    public invalid = false;\n\n    @property()\n    public label = '';\n\n    @property()\n    public placeholder = '';\n\n    @property({ attribute: 'type', reflect: true })\n    private _type: TextfieldType = 'text';\n\n    @state()\n    get type(): TextfieldType {\n        return textfieldTypes.find((t) => t === this._type) ?? 'text';\n    }\n\n    set type(val: TextfieldType) {\n        const prev = this._type;\n        this._type = val;\n        this.requestUpdate('type', prev);\n    }\n\n    @property()\n    public pattern?: string;\n\n    @property({ type: Boolean, reflect: true })\n    public grows = false;\n\n    @property({ type: Number })\n    public maxlength = -1;\n\n    @property({ type: Number })\n    public minlength = -1;\n\n    @property({ type: Boolean, reflect: true })\n    public multiline = false;\n\n    @property({ type: Boolean, reflect: true })\n    public readonly = false;\n\n    @property({ type: Boolean, reflect: true })\n    public valid = false;\n\n    @property({ type: String })\n    public set value(value: string | number) {\n        if (value === this.value) {\n            return;\n        }\n        const oldValue = this._value;\n        this._value = value;\n        this.requestUpdate('value', oldValue);\n    }\n\n    public get value(): string | number {\n        return this._value;\n    }\n\n    protected _value: string | number = '';\n\n    @property({ type: Boolean, reflect: true })\n    public quiet = false;\n\n    @property({ type: Boolean, reflect: true })\n    public required = false;\n\n    @property({ type: String, reflect: true })\n    public autocomplete?:\n        | HTMLInputElement['autocomplete']\n        | HTMLTextAreaElement['autocomplete'];\n\n    public override get focusElement(): HTMLInputElement | HTMLTextAreaElement {\n        return this.inputElement;\n    }\n\n    /**\n     * Sets the start and end positions of the current selection.\n     *\n     * @param selectionStart The 0-based index of the first selected character. An index greater than the length of the\n     *  element's value is treated as pointing to the end of the value.\n     * @param selectionEnd The 0-based index of the character after the last selected character. An index greater than\n     *  the length of the element's value is treated as pointing to the end of the value.\n     * @param [selectionDirection=\"none\"] A string indicating the direction in which the selection is considered to\n     *  have been performed.\n     */\n    public setSelectionRange(\n        selectionStart: number,\n        selectionEnd: number,\n        selectionDirection: 'forward' | 'backward' | 'none' = 'none'\n    ): void {\n        this.inputElement.setSelectionRange(\n            selectionStart,\n            selectionEnd,\n            selectionDirection\n        );\n    }\n\n    /**\n     * Selects all the text.\n     */\n    public select(): void {\n        this.inputElement.select();\n    }\n\n    protected handleInput(): void {\n        if (this.allowedKeys && this.inputElement.value) {\n            const regExp = new RegExp(`^[${this.allowedKeys}]*$`, 'u');\n            if (!regExp.test(this.inputElement.value)) {\n                const selectionStart = this.inputElement\n                    .selectionStart as number;\n                const nextSelectStart = selectionStart - 1;\n                this.inputElement.value = this.value.toString();\n                this.inputElement.setSelectionRange(\n                    nextSelectStart,\n                    nextSelectStart\n                );\n                return;\n            }\n        }\n        this.value = this.inputElement.value;\n    }\n\n    protected handleChange(): void {\n        this.dispatchEvent(\n            new Event('change', {\n                bubbles: true,\n                composed: true,\n            })\n        );\n    }\n\n    protected onFocus(): void {\n        this.focused = !this.readonly && true;\n    }\n\n    protected onBlur(): void {\n        this.focused = !this.readonly && false;\n    }\n\n    protected renderStateIcons(): TemplateResult | typeof nothing {\n        if (this.invalid) {\n            return html`\n                <sp-icon-alert id=\"invalid\" class=\"icon\"></sp-icon-alert>\n            `;\n        } else if (this.valid) {\n            return html`\n                <sp-icon-checkmark100\n                    id=\"valid\"\n                    class=\"icon spectrum-UIIcon-Checkmark100\"\n                ></sp-icon-checkmark100>\n            `;\n        }\n        return nothing;\n    }\n\n    protected get displayValue(): string {\n        return this.value.toString();\n    }\n\n    private get renderMultiline(): TemplateResult {\n        return html`\n            ${this.grows && !this.quiet\n                ? html`\n                      <div id=\"sizer\">${this.value}&#8203;</div>\n                  `\n                : nothing}\n            <!-- @ts-ignore -->\n            <textarea\n                aria-describedby=${this.helpTextId}\n                aria-label=${this.label || this.placeholder}\n                aria-invalid=${ifDefined(this.invalid || undefined)}\n                class=\"input\"\n                maxlength=${ifDefined(\n                    this.maxlength > -1 ? this.maxlength : undefined\n                )}\n                minlength=${ifDefined(\n                    this.minlength > -1 ? this.minlength : undefined\n                )}\n                pattern=${ifDefined(this.pattern)}\n                placeholder=${this.placeholder}\n                .value=${this.displayValue}\n                @change=${this.handleChange}\n                @input=${this.handleInput}\n                @focus=${this.onFocus}\n                @blur=${this.onBlur}\n                ?disabled=${this.disabled}\n                ?required=${this.required}\n                ?readonly=${this.readonly}\n                autocomplete=${ifDefined(this.autocomplete)}\n            ></textarea>\n        `;\n    }\n\n    private get renderInput(): TemplateResult {\n        return html`\n            <!-- @ts-ignore -->\n            <input\n                type=${this.type}\n                aria-describedby=${this.helpTextId}\n                aria-label=${this.label || this.placeholder}\n                aria-invalid=${ifDefined(this.invalid || undefined)}\n                class=\"input\"\n                maxlength=${ifDefined(\n                    this.maxlength > -1 ? this.maxlength : undefined\n                )}\n                minlength=${ifDefined(\n                    this.minlength > -1 ? this.minlength : undefined\n                )}\n                pattern=${ifDefined(this.pattern)}\n                placeholder=${this.placeholder}\n                .value=${live(this.displayValue)}\n                @change=${this.handleChange}\n                @input=${this.handleInput}\n                @focus=${this.onFocus}\n                @blur=${this.onBlur}\n                ?disabled=${this.disabled}\n                ?required=${this.required}\n                ?readonly=${this.readonly}\n                autocomplete=${ifDefined(this.autocomplete)}\n            />\n        `;\n    }\n\n    protected renderField(): TemplateResult {\n        return html`\n            ${this.renderStateIcons()}\n            ${this.multiline ? this.renderMultiline : this.renderInput}\n        `;\n    }\n\n    protected override render(): TemplateResult {\n        return html`\n            <div id=\"textfield\">${this.renderField()}</div>\n            ${this.renderHelpText(this.invalid)}\n        `;\n    }\n\n    protected override update(changedProperties: PropertyValues): void {\n        if (\n            changedProperties.has('value') ||\n            (changedProperties.has('required') && this.required)\n        ) {\n            this.updateComplete.then(() => {\n                this.checkValidity();\n            });\n        }\n        super.update(changedProperties);\n    }\n\n    public checkValidity(): boolean {\n        let validity = this.inputElement.checkValidity();\n        if (this.required || (this.value && this.pattern)) {\n            if ((this.disabled || this.multiline) && this.pattern) {\n                const regex = new RegExp(`^${this.pattern}$`, 'u');\n                validity = regex.test(this.value.toString());\n            }\n            if (typeof this.minlength !== 'undefined') {\n                validity =\n                    validity && this.value.toString().length >= this.minlength;\n            }\n            this.valid = validity;\n            this.invalid = !validity;\n        }\n        return validity;\n    }\n}\n\n/**\n * @element sp-textfield\n * @slot help-text - default or non-negative help text to associate to your form element\n * @slot negative-help-text - negative help text to associate to your form element when `invalid`\n */\nexport class Textfield extends TextfieldBase {\n    @property({ type: String })\n    public override set value(value: string) {\n        if (value === this.value) {\n            return;\n        }\n        const oldValue = this._value;\n        this._value = value;\n        this.requestUpdate('value', oldValue);\n    }\n\n    public override get value(): string {\n        return this._value;\n    }\n\n    protected override _value = '';\n}\n","/*\n * Copyright 2023 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\nimport { css } from 'lit';\nimport { MenuItem as SPMenuItem } from '@spectrum-web-components/menu';\n\nclass MenuItem extends SPMenuItem {\n  static get styles() {\n    return [\n      ...super.styles,\n      css`\n        :host {\n          height: 42px;\n        }\n\n        sp-icon-checkmark100 {\n          padding-top: 4px;\n        }\n      `,\n    ];\n  }\n}\n\ncustomElements.define('sp-menu-item', MenuItem);\n","/*\n * Copyright 2023 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nexport const APP_EVENTS = {\n  TOAST: 'Toast',\n  LIBRARY_LOADED: 'LibraryLoaded',\n  PLUGIN_LOADED: 'PluginLoaded',\n  PLUGIN_UNLOADED: 'PluginUnloaded',\n  PREVIEW_CONTENT: 'Preview',\n  LOCALE_SET: 'LocaleSet',\n  SEARCH_UPDATED: 'SearchUpdated',\n};\n\nexport const PLUGIN_EVENTS = {\n  TOAST: 'Toast',\n  SHOW_LOADER: 'ShowLoader',\n  HIDE_LOADER: 'HideLoader',\n};\n","/*\n * Copyright 2023 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\nimport { html, css } from 'lit';\nimport { SideNavItem as SPSideNavItem } from '@spectrum-web-components/sidenav';\nimport { ifDefined } from '@spectrum-web-components/base/src/directives.js';\nimport '@spectrum-web-components/icons-workflow/icons/sp-icon-copy.js';\nimport '@spectrum-web-components/icons-workflow/icons/sp-icon-preview.js';\nimport '@spectrum-web-components/icons-workflow/icons/sp-icon-info.js';\nimport '@spectrum-web-components/icons-workflow/icons/sp-icon-view-detail.js';\nimport '@spectrum-web-components/icon/sp-icon.js';\nimport '@spectrum-web-components/icons-workflow/icons/sp-icon-chevron-right.js';\nimport { APP_EVENTS } from '../../events/events.js';\n\nexport class SideNavItem extends SPSideNavItem {\n  static properties = {\n    disclosureArrow: false,\n    copy: false,\n    preview: false,\n    info: '',\n  };\n\n  static get styles() {\n    return [\n      ...super.styles,\n      css`\n        #item-link {\n          display: flex;\n          justify-content: space-between;\n          min-height: 42px;\n        }\n\n        .actions {\n          display: none;\n        }\n\n        #item-link:hover .actions{\n          display: flex;\n        }\n      `,\n    ];\n  }\n\n  get hasActions() {\n    return this.copy || this.preview || this.info;\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.info = this.getAttribute('data-info');\n  }\n\n  onClick() {\n    this.handleClick();\n    this.selected = false;\n  }\n\n  onPreview(e) {\n    e.stopPropagation();\n    this.dispatchEvent(new CustomEvent(APP_EVENTS.PREVIEW_CONTENT));\n  }\n\n  render() {\n    return html`\n      <a\n        target=${ifDefined(this.target)}\n        download=${ifDefined(this.download)}\n        rel=${ifDefined(this.rel)}\n        data-level=\"${this.depth}\"\n        @click=\"${this.onClick}\"\n        id=\"item-link\"\n        aria-current=${ifDefined(this.selected && this.href ? 'page' : undefined)}\n      >\n        <slot name=\"icon\"></slot>\n        ${this.label}\n        <slot></slot>\n        ${this.disclosureArrow ? html`<sp-icon-chevron-right slot=\"icon\"></sp-icon-chevron-right>` : ''}\n        ${this.hasActions ? html`\n          <div class='actions'>\n            ${this.info ? html`\n              <overlay-trigger placement=\"left\">\n                <sp-tooltip slot=\"hover-content\" variant=\"info\">${this.info}</sp-tooltip>\n                <sp-action-button quiet tip slot=\"trigger\">\n                  <sp-icon-info slot=\"icon\"></sp-icon-info>\n                </sp-action-button>\n              </overlay-trigger>\n            ` : ''}\n            ${this.preview ? html`\n              <sp-action-button quiet @click=${this.onPreview}>\n                <sp-icon-preview slot=\"icon\"></sp-icon-preview>\n              </sp-action-button>\n            ` : ''}\n          </div>\n        ` : ''}\n      </a>\n      ${this.expanded ? html` <slot name=\"descendant\"></slot> ` : html``}\n    `;\n  }\n}\n\ncustomElements.define('sp-sidenav-item', SideNavItem);\n","/*\n * Copyright 2023 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\n/* eslint-disable no-plusplus */\n\nexport class EventEmitter {\n  listeners = [];\n\n  /**\n   * Add event listener.\n   */\n  addEventListener(type, callback) {\n    const listener = { type, callback };\n    this.listeners.push(listener);\n    return listener;\n  }\n\n  /**\n   * Remove event listener.\n   * @param listener - Event listener to remove.\n   */\n  removeEventListener(listener) {\n    for (let c = 0; c < this.listeners.length; c++) {\n      if (listener === this.listeners[c]) {\n        this.listeners.splice(c, 1);\n        return;\n      }\n    }\n  }\n\n  /**\n   * Remove event listeners.\n   * @param listeners - List of event listeners to remove.\n   */\n  removeEventListeners(listeners) {\n    listeners.forEach((listener) => {\n      this.removeEventListener(listener);\n    });\n  }\n\n  /**\n   * Trigger event.\n   * @param ce - Custom event to dispatch.\n   */\n  dispatchEvent(ce) {\n    const listeners = this.listeners.slice();\n    listeners.forEach((l) => {\n      if (ce.type === l.type) {\n        // @ts-ignore\n        l.callback.apply(this, [ce]);\n      }\n    });\n  }\n}\n","/*\n * Copyright 2023 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\n/* eslint-disable no-underscore-dangle */\n\nimport { EventEmitter } from './eventemitter.js';\n\nexport class EventBus extends EventEmitter {\n  static _instance;\n\n  constructor() {\n    super();\n    if (!EventBus._instance) {\n      EventBus._instance = this;\n    }\n    return EventBus._instance;\n  }\n\n  static get instance() {\n    if (!EventBus._instance) {\n      EventBus._instance = new EventBus();\n    }\n    return EventBus._instance;\n  }\n}\n","/*\n * Copyright 2023 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport { EventBus } from '../events/eventbus.js';\nimport { APP_EVENTS } from '../events/events.js';\n\nexport async function fetchLibrary(href) {\n  const resp = await fetch(href);\n  if (!resp.ok) return null;\n  return resp.json();\n}\n\nexport async function getExtendedLibrary(href) {\n  if (href) {\n    return fetchLibrary(href);\n  }\n\n  return Promise.resolve();\n}\n\nexport async function combineLibraries(base, supplied) {\n  const library = {};\n\n  if (base[':type'] === 'multi-sheet') {\n    base[':names'].forEach((key) => {\n      library[key] = base[key].data;\n    });\n  } else {\n    library.blocks = base.data;\n  }\n\n  if (supplied) {\n    if (supplied[':type'] === 'multi-sheet') {\n      supplied[':names'].forEach((key) => {\n        if (library[key]) {\n          library[key].push(...supplied[key].data);\n          return;\n        }\n\n        library[key] = supplied[key].data;\n      });\n    } else {\n      if (library.blocks === undefined) {\n        library.blocks = [];\n      }\n\n      library.blocks.push(...supplied.data);\n    }\n  }\n  return library;\n}\n\nexport function isDev() {\n  return window.libraryDev;\n}\n\nexport async function loadLibrary(appModel, config) {\n  const { appStore } = appModel;\n  let { libraries } = appModel;\n\n  appStore.config = config;\n  try {\n    const baseLibrary = await fetchLibrary(config.base);\n    const extendedLibrary = await getExtendedLibrary(config.extends);\n    libraries = await combineLibraries(baseLibrary, extendedLibrary);\n    appStore.libraries = libraries;\n    EventBus.instance.dispatchEvent(new CustomEvent(APP_EVENTS.LIBRARY_LOADED));\n  } catch (error) {\n    // eslint-disable-next-line no-console\n    console.error('unable to load library', error);\n  }\n}\n","/*\n * Copyright 2023 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\n/* eslint-disable no-underscore-dangle */\nimport { EventBus } from '../events/eventbus.js';\n\nexport const defaultState = {\n  initialized: false,\n  activePlugin: undefined,\n  activePluginPath: undefined,\n  searchQuery: '',\n  libraries: [],\n  config: {},\n  localeDict: {},\n};\n\n/* eslint-disable no-param-reassign, no-shadow */\nexport function store(data = {}, name = 'store') {\n  /**\n   * Emit a custom event\n   * @param  {String} type   The event type\n   * @param  {*}      detail Any details to pass along with the event\n   */\n  function emit(type, prop, detail) {\n    // Create a new event\n    const event = new CustomEvent(prop, {\n      bubbles: true,\n      cancelable: true,\n      detail,\n    });\n\n    // Dispatch the event\n    return EventBus.instance.dispatchEvent(event);\n  }\n\n  function handler(name, data) {\n    return {\n      get(obj, prop) {\n        if (prop === '_isProxy') return true;\n        /**\n        * Checks if the property value is an object or an array.\n        * If it is, and if the property does not already have a\n        * proxy attached to it, then create a new proxy object.\n        */\n        if (typeof obj[prop] === 'object' && obj[prop] !== null && !obj[prop]._isProxy) {\n          obj[prop] = new Proxy(obj[prop], handler(name, data));\n        }\n        return obj[prop];\n      },\n      set(obj, prop, value) {\n        if (obj[prop] === value) return true;\n        obj[prop] = value;\n        emit(name, prop, data);\n        return true;\n      },\n      deleteProperty(obj, prop) {\n        delete obj[prop];\n        emit(name, prop, data);\n        return true;\n      },\n    };\n  }\n\n  return new Proxy(data, handler(name, data));\n}\n","/*\n * Copyright 2023 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\nimport { isDev } from '../utils/library.js';\nimport { store, defaultState } from '../store/store.js';\n\nexport default class AppModel {\n  static host = 'https://main--franklin-library-host--dylandepass.hlx.live/library';\n\n  static appStore;\n\n  static libraries;\n\n  static init() {\n    AppModel.appStore = store(defaultState, 'app');\n    AppModel.appStore.webRoot = isDev() ? './src/' : AppModel.host;\n  }\n}\n","/*\n * Copyright 2023 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\nimport { LitElement, html, css } from 'lit';\nimport '@spectrum-web-components/icons-workflow/icons/sp-icon-chevron-left.js';\nimport { EventBus } from '../../events/eventbus.js';\nimport AppModel from '../../models/app-model.js';\nimport { unloadPlugin } from '../../utils/plugin.js';\nimport { APP_EVENTS } from '../../events/events.js';\n\nexport class Header extends LitElement {\n  static properties = {\n    _searchActivated: { type: Boolean },\n    _pluginActive: { type: Boolean },\n\n    headerTitle: { type: String },\n    searchEnabled: { type: Boolean },\n  };\n\n  static styles = css`\n    .search {\n      padding: 10px 5px;\n      display: grid;\n      grid-template-columns: 38px 1fr 38px;\n      gap: 10px;\n    }\n\n    .search > div {\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n\n    .search .title sp-search {\n      display: none;\n      width: 100%;\n    }\n\n    .search .title.search-active sp-search {\n      display: block;\n      width: 100%;\n    }\n\n    .search .title.search-active > span {\n      display: none;\n    }\n\n    .logo-container {\n      padding-left: 10px;\n      height: 32px;\n    }\n  `;\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    EventBus.instance.addEventListener(APP_EVENTS.PLUGIN_LOADED, () => {\n      if (AppModel.appStore.activePlugin) {\n        const { title, searchEnabled } = AppModel.appStore.activePlugin;\n        this.headerTitle = title;\n\n        if (searchEnabled) {\n          this.searchEnabled = true;\n        }\n\n        this._pluginActive = true;\n      }\n    });\n\n    EventBus.instance.addEventListener(APP_EVENTS.PLUGIN_UNLOADED, () => {\n      this.headerTitle = AppModel.appStore.localeDict.appTitle;\n    });\n\n    EventBus.instance.addEventListener(APP_EVENTS.LOCALE_SET, () => {\n      this.headerTitle = AppModel.appStore.localeDict.appTitle;\n    });\n  }\n\n  onBack() {\n    this._pluginActive = false;\n    this.searchEnabled = false;\n    this._searchActivated = false;\n    unloadPlugin(AppModel);\n    const title = this.renderRoot.querySelector('.title');\n    title?.classList.remove('search-active');\n\n    const searchInput = this.renderRoot.querySelector('sp-search');\n    searchInput.value = '';\n  }\n\n  activateSearch() {\n    const title = this.renderRoot.querySelector('.title');\n\n    this._searchActivated = !this._searchActivated;\n    if (this._searchActivated) {\n      title?.classList.add('search-active');\n    } else {\n      title?.classList.remove('search-active');\n    }\n\n    const searchInput = this.renderRoot.querySelector('sp-search');\n    searchInput?.focus();\n  }\n\n  onSearch(event) {\n    AppModel.appStore.searchQuery = event.target.value;\n    EventBus.instance.dispatchEvent(new CustomEvent(APP_EVENTS.SEARCH_UPDATED));\n  }\n\n  render() {\n    return html`<div class=\"search\">\n      <div>\n        ${this._pluginActive ? html`\n              <sp-action-button quiet @click=${this.onBack} id=\"back-button\">\n                <sp-icon-chevron-left slot=\"icon\"></sp-icon-chevron-left>\n              </sp-action-button>\n              ` : html`\n              <div class=\"logo-container\">\n                <sp-icon\n                  label=\"adobe logo\"\n                  size=\"xxl\"\n                  src=\"data:image/svg+xml;base64,PHN2ZyBpZD0iQWRvYmVFeHBlcmllbmNlQ2xvdWQiIGRhdGEtbmFtZT0iTGF5ZXIgMSIgdmlld0JveD0iLTUgLTUgMjUwIDI0NCIgd2lkdGg9IjI1MCIgaGVpZ2h0PSIyNDQiCiAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cmVjdCBoZWlnaHQ9IjIzNCIgcng9IjQyLjUiIHdpZHRoPSIyNDAiIGZpbGw9IiNmYTBmMDAiLz4KICA8cGF0aCBkPSJNMTg2LjYxNyAxNzUuOTVoLTI4LjUwNmE2LjI0MyA2LjI0MyAwIDAgMS01Ljg0Ny0zLjc2OWwtMzAuOTQ3LTcyLjM1OWExLjM2NCAxLjM2NCAwIDAgMC0yLjYxMS0uMDM0TDk5LjQyIDE0NS43MzFhMS42MzUgMS42MzUgMCAwIDAgMS41MDYgMi4yNjloMjEuMmEzLjI3IDMuMjcgMCAwIDEgMy4wMSAxLjk5NGw5LjI4MSAyMC42NTVhMy44MTIgMy44MTIgMCAwIDEtMy41MDcgNS4zMDFINTMuNzM0YTMuNTE4IDMuNTE4IDAgMCAxLTMuMjEzLTQuOTA0bDQ5LjA5LTExNi45MDJBNi42MzkgNi42MzkgMCAwIDEgMTA1Ljg0MyA1MGgyOC4zMTRhNi42MjggNi42MjggMCAwIDEgNi4yMzIgNC4xNDRsNDkuNDMgMTE2LjkwMmEzLjUxNyAzLjUxNyAwIDAgMS0zLjIwMiA0LjkwNHoiIGRhdGEtbmFtZT0iMjU2IiBmaWxsPSIjZmZmIi8+Cjwvc3ZnPg==\"\n                ></sp-icon>\n              </div>\n            `}\n      </div>\n      <div class=\"title\">\n        <span>${this.headerTitle}</span>\n        <sp-search\n          @input=${this.onSearch}\n          @submit=${e => e.preventDefault()}\n        ></sp-search>\n      </div>\n      <div>\n        ${this._pluginActive && this.searchEnabled ? html`\n          <sp-action-button id=\"search-button\" quiet toggles @click=${this.activateSearch}>\n            <sp-icon-search slot=\"icon\"></sp-icon-search>\n          </sp-action-button>` : ''}\n      </div>\n    </div>`;\n  }\n}\n\ncustomElements.define('library-header', Header);\n","/*\n * Copyright 2023 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\nimport { EventBus } from '../events/eventbus.js';\nimport { APP_EVENTS } from '../events/events.js';\n\nexport async function loadPlugin(appModel, name, path) {\n  const { appStore } = appModel;\n  const importedPlugin = await import(path);\n  appStore.pluginData = appStore.libraries[name];\n  appStore.activePluginPath = path;\n  appStore.activePlugin = importedPlugin.default;\n  EventBus.instance.dispatchEvent(new CustomEvent(APP_EVENTS.PLUGIN_LOADED));\n}\n\nexport async function unloadPlugin(appModel) {\n  const { appStore } = appModel;\n  appStore.activePlugin = undefined;\n  appStore.pluginData = undefined;\n  appStore.activePluginPath = undefined;\n  EventBus.instance.dispatchEvent(new CustomEvent(APP_EVENTS.PLUGIN_UNLOADED));\n}\n","/*\n * Copyright 2023 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\nimport { LitElement, html, css } from 'lit';\n\nexport class IllustratedMessage extends LitElement {\n  static properties = {\n    heading: { type: String },\n    description: { type: String },\n  };\n\n  static styles = css`\n    .message-container {\n      width: 100%;\n      height: 100%;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n    }\n  `;\n\n  connectedCallback() {\n    super.connectedCallback();\n  }\n\n  render() {\n    return html`\n      <div class=\"message-container\">\n        <sp-illustrated-message\n        heading=${this.heading}\n        description=${this.description}\n        tabindex=\"0\"\n        >\n            <svg\n                xmlns=\"http://www.w3.org/2000/svg\"\n                viewBox=\"0 0 150 103\"\n                width=\"150\"\n                height=\"103\"\n            >\n                <path\n                    d=\"M133.7,8.5h-118c-1.9,0-3.5,1.6-3.5,3.5v27c0,0.8,0.7,1.5,1.5,1.5s1.5-0.7,1.5-1.5V23.5h119V92c0,0.3-0.2,0.5-0.5,0.5h-118c-0.3,0-0.5-0.2-0.5-0.5V69c0-0.8-0.7-1.5-1.5-1.5s-1.5,0.7-1.5,1.5v23c0,1.9,1.6,3.5,3.5,3.5h118c1.9,0,3.5-1.6,3.5-3.5V12C137.2,10.1,135.6,8.5,133.7,8.5z M15.2,21.5V12c0-0.3,0.2-0.5,0.5-0.5h118c0.3,0,0.5,0.2,0.5,0.5v9.5H15.2z M32.6,16.5c0,0.6-0.4,1-1,1h-10c-0.6,0-1-0.4-1-1s0.4-1,1-1h10C32.2,15.5,32.6,15.9,32.6,16.5z M13.6,56.1l-8.6,8.5C4.8,65,4.4,65.1,4,65.1c-0.4,0-0.8-0.1-1.1-0.4c-0.6-0.6-0.6-1.5,0-2.1l8.6-8.5l-8.6-8.5c-0.6-0.6-0.6-1.5,0-2.1c0.6-0.6,1.5-0.6,2.1,0l8.6,8.5l8.6-8.5c0.6-0.6,1.5-0.6,2.1,0c0.6,0.6,0.6,1.5,0,2.1L15.8,54l8.6,8.5c0.6,0.6,0.6,1.5,0,2.1c-0.3,0.3-0.7,0.4-1.1,0.4c-0.4,0-0.8-0.1-1.1-0.4L13.6,56.1z\"\n                ></path>\n            </svg>\n        </sp-illustrated-message>\n      </div>`;\n  }\n}\n\ncustomElements.define('illustrated-message', IllustratedMessage);\n","/*\n * Copyright 2023 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\n\n/* eslint-disable no-param-reassign */\nexport function createTag(tag, attributes, html) {\n  const el = document.createElement(tag);\n  if (html) {\n    if (\n      html instanceof HTMLElement\n      || html instanceof SVGElement\n      || html instanceof DocumentFragment\n    ) {\n      el.append(html);\n    } else if (Array.isArray(html)) {\n      el.append(...html);\n    } else {\n      el.insertAdjacentHTML('beforeend', html);\n    }\n  }\n  if (attributes) {\n    Object.entries(attributes).forEach(([key, val]) => {\n      el.setAttribute(key, val);\n    });\n  }\n  return el;\n}\n\nexport function createCopy(blob) {\n  const data = [new ClipboardItem({ [blob.type]: blob })];\n  navigator.clipboard.write(data);\n}\n\nexport const getMetadata = el => [...el.childNodes].reduce((rdx, row) => {\n  if (row.children) {\n    const key = row.children[0].textContent.trim().toLowerCase();\n    const content = row.children[1];\n    const text = content?.textContent.trim().toLowerCase();\n    if (key && content) rdx[key] = { content, text };\n  }\n  return rdx;\n}, {});\n\n/**\n * Loads a CSS file.\n * @param {string} href The path to the CSS file\n */\nexport function loadCSS(href, callback) {\n  if (!document.querySelector(`head > link[href=\"${href}\"]`)) {\n    const link = document.createElement('link');\n    link.setAttribute('rel', 'stylesheet');\n    link.setAttribute('href', href);\n    if (typeof callback === 'function') {\n      link.onload = e => callback(e.type);\n      link.onerror = e => callback(e.type);\n    }\n    document.head.appendChild(link);\n  } else if (typeof callback === 'function') {\n    callback('noop');\n  }\n}\n\nexport function capitalize(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\n","/*\n * Copyright 2023 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\nimport { LitElement, html, css } from 'lit';\nimport AppModel from '../../models/app-model.js';\nimport { EventBus } from '../../events/eventbus.js';\nimport { isDev } from '../../utils/library.js';\nimport { capitalize } from '../../utils/dom.js';\nimport { APP_EVENTS, PLUGIN_EVENTS } from '../../events/events.js';\nimport { loadPlugin } from '../../utils/plugin.js';\n\nconst plugins = {\n  blocks: isDev() ? '../../src/plugins/blocks/blocks.js' : `${AppModel.host}/plugins/blocks/blocks.js`,\n  taxonomy: isDev() ? '../../src/plugins/taxonomy/taxonomy.js' : `${AppModel.host}/plugins/taxonomy/taxonomy.js`,\n};\n\nexport class LibraryList extends LitElement {\n  static properties = {\n    libraries: undefined,\n  };\n\n  static styles = css`\n    sp-sidenav {\n      width: 100%;\n    }\n  `;\n\n  connectedCallback() {\n    super.connectedCallback();\n\n    EventBus.instance.addEventListener(APP_EVENTS.LIBRARY_LOADED, () => {\n      this.libraries = AppModel.appStore.libraries;\n    });\n  }\n\n  async onSelect(e) {\n    const { value } = e.target;\n    const { config } = AppModel.appStore;\n\n    const pluginPath = config[value] ?? plugins[value];\n    if (pluginPath) {\n      await loadPlugin(AppModel, value, pluginPath);\n      return;\n    }\n\n    EventBus.instance.dispatchEvent(new CustomEvent(PLUGIN_EVENTS.TOAST, {\n      detail: {\n        variant: 'negative',\n        message: AppModel.appStore.localeDict.unknownPlugin,\n      },\n    }));\n  }\n\n  renderLibraries() {\n    if (this.libraries) {\n      return Object.keys(this.libraries).map(\n        key => html`<sp-sidenav-item value=${key} disclosureArrow=\"true\" data-testid=\"library-item\">${capitalize(key)}</sidenav-item>`,\n      );\n    }\n\n    return '';\n  }\n\n  render() {\n    return html`<div class=\"home\">\n      <sp-sidenav @click=${this.onSelect} data-testid=${this.libraries ? 'libraries-loaded' : ''}>\n       ${this.renderLibraries()}\n      </sp-sidenav>\n    </div>`;\n  }\n}\n\ncustomElements.define('library-list', LibraryList);\n","/*\n * Copyright 2023 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\nimport { LitElement, html, css } from 'lit';\nimport { createRef, ref } from 'lit/directives/ref.js';\nimport { createTag } from '../../utils/dom.js';\nimport { EventBus } from '../../events/eventbus.js';\nimport { APP_EVENTS, PLUGIN_EVENTS } from '../../events/events.js';\nimport AppModel from '../../models/app-model.js';\n\nexport class PluginRenderer extends LitElement {\n  progressContainer = createRef();\n\n  static styles = css`\n    sp-sidenav {\n      width: 100%;\n    }\n\n    .progress-container {\n      position: absolute;\n      width: 100%;\n      height: 100%;\n      display: flex;\n      top: 0;\n      align-items: center;\n      justify-content: center;\n      display: none;\n    }\n\n    .progress-container.visible {\n      display: flex;\n    }\n\n    .plugin-root {\n      height: 100%;\n      overflow-y: auto;\n    }\n  `;\n\n  connectedCallback() {\n    super.connectedCallback();\n    EventBus.instance.addEventListener(APP_EVENTS.PLUGIN_LOADED, () => {\n      const root = createTag('div', { class: 'plugin-root', 'data-testid': 'plugin-root' });\n      this.renderRoot.prepend(root);\n\n      this.loadPluginStylesheet();\n\n      root.addEventListener(PLUGIN_EVENTS.SHOW_LOADER, this.displayLoader.bind(this));\n      root.addEventListener(PLUGIN_EVENTS.TOAST, this.sendToast);\n      root.addEventListener(PLUGIN_EVENTS.HIDE_LOADER, this.hideLoader.bind(this));\n\n      AppModel.appStore.activePlugin.decorate(root, AppModel.appStore.pluginData);\n    });\n\n    EventBus.instance.addEventListener(APP_EVENTS.PLUGIN_UNLOADED, () => {\n      const root = this.renderRoot.querySelector('.plugin-root');\n      if (root) {\n        root.remove();\n      }\n    });\n\n    EventBus.instance.addEventListener(APP_EVENTS.SEARCH_UPDATED, () => {\n      const root = this.renderRoot.querySelector('.plugin-root');\n      if (root) {\n        root.innerHTML = '';\n        AppModel.appStore.activePlugin.decorate(\n          root,\n          AppModel.appStore.pluginData,\n          AppModel.appStore.searchQuery,\n        );\n      }\n    });\n  }\n\n  loadPluginStylesheet() {\n    const styleSheet = document.createElement('link');\n    styleSheet.setAttribute('rel', 'stylesheet');\n\n    const href = AppModel.appStore.activePluginPath.replace('.js', '.css');\n    styleSheet.setAttribute('href', href);\n    this.renderRoot.prepend(styleSheet);\n  }\n\n  displayLoader() {\n    this.progressContainer.value?.classList.add('visible');\n  }\n\n  hideLoader() {\n    this.progressContainer.value?.classList.remove('visible');\n  }\n\n  sendToast(event) {\n    EventBus.instance.dispatchEvent(new CustomEvent(PLUGIN_EVENTS.TOAST, { detail: event.detail }));\n  }\n\n  render() {\n    return html`\n      <div class=\"progress-container\" ${ref(this.progressContainer)}>\n        <sp-progress-circle indeterminate label=\"loading plugin\"></sp-progress-circle>\n      </div>\n    `;\n  }\n}\n\ncustomElements.define('plugin-renderer', PluginRenderer);\n","/*\n * Copyright 2023 Adobe. All rights reserved.\n * This file is licensed to you under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License. You may obtain a copy\n * of the License at http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software distributed under\n * the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR REPRESENTATIONS\n * OF ANY KIND, either express or implied. See the License for the specific language\n * governing permissions and limitations under the License.\n */\nimport { LitElement, html, css } from 'lit';\nimport '@spectrum-web-components/theme/sp-theme.js';\nimport '@spectrum-web-components/theme/theme-dark.js';\nimport '@spectrum-web-components/theme/theme-light.js';\nimport '@spectrum-web-components/theme/scale-medium.js';\nimport '@spectrum-web-components/sidenav/sp-sidenav.js';\nimport '@spectrum-web-components/icons/sp-icons-medium.js';\nimport '@spectrum-web-components/action-button/sp-action-button.js';\nimport '@spectrum-web-components/search/sp-search.js';\nimport '@spectrum-web-components/divider/sp-divider.js';\nimport '@spectrum-web-components/toast/sp-toast.js';\nimport '@spectrum-web-components/tooltip/sp-tooltip.js';\nimport '@spectrum-web-components/overlay/overlay-trigger.js';\nimport '@spectrum-web-components/progress-circle/sp-progress-circle.js';\nimport '@spectrum-web-components/illustrated-message/sp-illustrated-message.js';\nimport '@spectrum-web-components/icons-workflow/icons/sp-icon-search.js';\nimport '@spectrum-web-components/button/sp-button.js';\nimport '@spectrum-web-components/icon/sp-icon.js';\nimport '@spectrum-web-components/menu/sp-menu.js';\nimport './components/menu-item/menu-item.js';\nimport './components/sidenav/sidenav-item.js';\nimport './components/header/header.js';\nimport './components/illustrated-message/illustrated-message.js';\nimport './views/library-list/library-list.js';\nimport './views/plugin-renderer/plugin-renderer.js';\nimport AppModel from './models/app-model.js';\nimport { EventBus } from './events/eventbus.js';\nimport { createTag } from './utils/dom.js';\nimport { APP_EVENTS } from './events/events.js';\nimport { loadLibrary } from './utils/library.js';\n\nexport { PLUGIN_EVENTS } from './events/events.js';\n\nexport class FranklinLibrary extends LitElement {\n  static properties = {\n    theme: undefined,\n  };\n\n  static styles = css`\n    * {\n      box-sizing: border-box;\n    }\n\n    main {\n      background-color: var(--spectrum-global-color-gray-100);\n      color: var(--spectrum-global-color-gray-800);\n      height: 100%;\n      max-width: 360px;\n      height: 364px;\n      overflow: hidden;\n      position: relative;\n      display: flex;\n      flex-direction: column;\n    }\n\n    main .container {\n      position: relative;\n      height: calc(100% - 52px);\n      overflow-y: auto;\n      overflow-x: hidden;\n    }\n\n    .search {\n      padding: 10px 10px;\n    }\n\n    .search sp-search {\n      width: 100%;\n    }\n\n    library-list {\n      width: 100%;\n      padding: 5px;\n      padding-top: 0;\n      transition: transform 0.2s ease-in-out;\n      position: absolute;\n    }\n\n    library-list.inset {\n      transform: translateX(-360px);\n    }\n\n    plugin-renderer {\n      transform: translateX(360px);\n      list-style: none;\n      padding: 0;\n      margin: 0;\n      position: absolute;\n      inset: 0;\n      transition: transform 0.2s ease-in-out;\n      visibility: hidden;\n    }\n\n    plugin-renderer.inset {\n      transform: translateX(0);\n      visibility: visible;\n    }\n\n    .toast-container {\n      width: 100%;\n      display: flex;\n      justify-content: center;\n    }\n\n    sp-toast {\n      position: absolute;\n      bottom: 10px;\n      margin: 0 auto;\n    }\n  `;\n\n  async loadLocaleDict(lang) {\n    const dict = {};\n    const dictPath = `${AppModel.appStore.webRoot}/locales/${lang}/messages.json`;\n    try {\n      const res = await fetch(dictPath);\n      const messages = await res.json();\n      Object.keys(messages).forEach((key) => {\n        dict[key] = messages[key].message;\n      });\n    } catch (e) {\n      /* istanbul ignore next */\n      console.error(`failed to fetch dictionary from ${dictPath}`); // eslint-disable-line no-console\n    }\n\n    AppModel.appStore.localeDict = dict;\n    EventBus.instance.dispatchEvent(new CustomEvent(APP_EVENTS.LOCALE_SET));\n  }\n\n  isValidConfig(config) {\n    // Was the config set via a property?\n    if (config?.base) {\n      return true;\n    }\n\n    const { searchParams } = new URL(window.location.href);\n    console.log(window.location.href);\n    const params = {};\n\n    for (const [key, value] of searchParams.entries()) {\n      console.log('found param', key, value);\n      params[key] = value;\n    }\n\n    // Config is only valid if it contains a library\n    if (params.base) {\n      this.config = params;\n      return true;\n    }\n\n    // eslint-disable-next-line no-console\n    console.error('Missing base configuration');\n    return false;\n  }\n\n  async connectedCallback() {\n    super.connectedCallback();\n    this.getTheme();\n    AppModel.init();\n\n    // Listen for system theme changes\n    window.matchMedia('(prefers-color-scheme: dark)').addListener((e) => {\n      this.theme = e.matches ? 'dark' : 'light';\n    });\n\n    EventBus.instance.addEventListener(APP_EVENTS.LOCALE_SET, () => {\n      this.requestUpdate();\n      if (!this.configured) {\n        const message = createTag('illustrated-message', {\n          heading: AppModel.appStore.localeDict.invalidConfiguration,\n          description: AppModel.appStore.localeDict.invalidConfigurationDescription,\n        });\n        this.renderRoot.querySelector('.container')?.append(message);\n      }\n    });\n\n    this.configured = this.isValidConfig(this.config);\n\n    this.loadLocaleDict('en');\n\n    if (!this.configured) return;\n\n    await loadLibrary(\n      AppModel,\n      this.config,\n    );\n\n    const home = this.renderRoot.querySelector('library-list');\n    const library = this.renderRoot.querySelector('plugin-renderer');\n\n    EventBus.instance.addEventListener(APP_EVENTS.PLUGIN_LOADED, () => {\n      home?.classList.add('inset');\n      library?.classList.add('inset');\n    });\n\n    EventBus.instance.addEventListener(APP_EVENTS.PLUGIN_UNLOADED, () => {\n      home?.classList.remove('inset');\n      library?.classList.remove('inset');\n    });\n\n    EventBus.instance.addEventListener(APP_EVENTS.TOAST, (e) => {\n      const toastContainer = this.renderRoot.querySelector('.toast-container');\n      const toast = createTag('sp-toast', { open: true, variant: e.detail.variant ?? 'positive', timeout: 200 });\n      toast.textContent = e.detail.message ?? 'Done';\n      toastContainer.append(toast);\n    });\n  }\n\n  getTheme() {\n    this.theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';\n  }\n\n  render() {\n    return html`\n      <sp-theme theme=\"spectrum\" color=${this.theme} scale=\"medium\">\n        <main>\n          <library-header></library-header>\n          <sp-divider size=\"s\"></sp-divider>\n          <div class=\"container\">\n            ${this.configured ? html`\n              <library-list></library-list>\n              <plugin-renderer></plugin-renderer>            \n            ` : ''}\n          </div>\n          <div class=\"toast-container\"></div>\n        </main>\n      </sp-theme>\n    `;\n  }\n}\n\ncustomElements.define('franklin-library', FranklinLibrary);\n"],"names":["customElements","define","SPMenuItem","styles","super","css","APP_EVENTS","TOAST","LIBRARY_LOADED","PLUGIN_LOADED","PLUGIN_UNLOADED","PREVIEW_CONTENT","LOCALE_SET","SEARCH_UPDATED","PLUGIN_EVENTS","SideNavItem","SPSideNavItem","hasActions","copy","this","preview","info","connectedCallback","getAttribute","onClick","handleClick","selected","onPreview","e","stopPropagation","dispatchEvent","CustomEvent","render","html","ifDefined","target","download","rel","depth","href","label","disclosureArrow","expanded","_defineProperty","EventEmitter","constructor","addEventListener","type","callback","listener","listeners","push","removeEventListener","c","length","splice","removeEventListeners","forEach","ce","slice","l","apply","EventBus","_instance","instance","fetchLibrary","resp","fetch","ok","json","isDev","window","libraryDev","loadLibrary","appModel","config","appStore","libraries","baseLibrary","base","extendedLibrary","Promise","resolve","extends","supplied","library","key","data","blocks","error","console","defaultState","initialized","activePlugin","activePluginPath","searchQuery","localeDict","AppModel","static","name","emit","prop","detail","event","bubbles","cancelable","Proxy","handler","get","obj","_isProxy","set","value","deleteProperty","webRoot","host","Header","LitElement","title","searchEnabled","headerTitle","_pluginActive","appTitle","onBack","_searchActivated","pluginData","renderRoot","querySelector","classList","remove","activateSearch","add","searchInput","focus","onSearch","preventDefault","Boolean","String","IllustratedMessage","heading","description","createTag","tag","attributes","el","document","createElement","HTMLElement","SVGElement","DocumentFragment","append","Array","isArray","insertAdjacentHTML","Object","entries","val","setAttribute","plugins","taxonomy","LibraryList","async","pluginPath","path","importedPlugin","default","variant","message","unknownPlugin","renderLibraries","keys","map","str","charAt","toUpperCase","onSelect","PluginRenderer","args","root","class","prepend","loadPluginStylesheet","displayLoader","bind","sendToast","hideLoader","decorate","innerHTML","styleSheet","replace","_a","progressContainer","ref","FranklinLibrary","lang","dict","dictPath","messages","isValidConfig","searchParams","URL","location","log","params","getTheme","init","matchMedia","addListener","theme","matches","requestUpdate","configured","invalidConfiguration","invalidConfigurationDescription","loadLocaleDict","home","toastContainer","toast","open","timeout","textContent"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kMAiQgD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ooBAkClC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}